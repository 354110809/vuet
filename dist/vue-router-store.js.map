{"version":3,"file":"vue-router-store.js","sources":["../src/install.js","../src/options.js","../src/utils.js","../src/debug.js","../src/vue-router-store.js","../src/index.js"],"sourcesContent":["export let _Vue = null\n\nconst isDef = v => v !== undefined\n\nexport default function install (Vue) {\n  if (install.installed) return\n  install.installed = true\n  _Vue = Vue\n  Object.defineProperty(Vue.prototype, '$vrs', {\n    get () { return this.$root._vrs }\n  })\n  Object.defineProperty(Vue.prototype, '$rs', {\n    get () { return this.$root._vrs.store }\n  })\n  Vue.mixin({\n    beforeCreate () {\n      if (isDef(this.$options.vrs)) {\n        this._vrs = this.$options.vrs\n      }\n    }\n  })\n}\n","export default function options (opt = {}) {\n  const options = {\n    pagekey: 'page', // this.$route.query[pagekey]\n    queryKey: 'query', // this.$data[queryKey]\n    fetchBefore () {\n      // Callback method before requesting to send\n      // This points to the component instance\n    },\n    fetchAfter () {\n      // After the request ends, the callback method, regardless of success or failure\n      // This points to the component instance\n    },\n    baseData () {\n      // All use\n      return {}\n    },\n    baseListData () {\n      // List all use\n      return {}\n    },\n    baseDetailData () {\n      // Detail all use\n      return {}\n    },\n    fetchSuccess (res, type) {\n      // Request successful callback\n    },\n    fetchError (e, type) {\n      // Request failed callback\n    },\n    modules: {}\n  }\n  return Object.assign(options, opt)\n}\n","const utils = {\n  isObject (obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isArray (arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]'\n  },\n  isFunction (arr) {\n    return Object.prototype.toString.call(arr) === '[object Function]'\n  },\n  next (fn, resolve, reject = (e) => {}) {\n    let btn = false\n    const back = fn(resolve, reject)\n    if (typeof back === 'object' && utils.isFunction(back.then)) {\n      back\n        .then((res) => {\n          if (btn) return\n          btn = true\n          resolve(res)\n        })\n        .catch(reject)\n    }\n  }\n}\nexport default utils\n","export default {\n  error (msg) {\n    throw new Error(`[vue-router-store] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vue-router-store] ${msg}`)\n    }\n  }\n}\n","import { _Vue } from './install'\nimport options from './options'\nimport utils from './utils'\nimport debug from './debug'\n\nexport default class VueRouterStore {\n  constructor (opt) {\n    this.options = options(opt = opt || {})\n    this._init()\n  }\n  _init () {\n    const store = {}\n    const _fetchKey = {}\n    Object.keys(this.options.modules).forEach(name => {\n      store[name] = {\n        list: this._getData(name, 'list'),\n        detail: this._getData(name, 'detail')\n      }\n      _fetchKey[name] = {\n        list: '',\n        detail: ''\n      }\n    })\n    this.store = new _Vue({\n      data: {\n        store\n      }\n    }).$data.store\n    this._fetchKey = _fetchKey\n  }\n  _getModuleOptions (name, type) {\n    const options = this.options.modules[name]\n    const defaults = {\n      pagekey: this.options.pagekey,\n      queryKey: this.options.queryKey,\n      fetch () {\n        return {}\n      },\n      data () {\n        return {}\n      }\n    }\n    Object.keys(options).forEach(k => {\n      let name = (k.split(type)[1] || '')\n      name = name.replace(/^(\\w)/, (v) => v.toLowerCase()) // 首字母大写\n      if (name) {\n        defaults[name] = options[k]\n      }\n    })\n    return defaults\n  }\n  _returnComput (comput, diy) {\n    const obj = {}\n    if (!diy.length) return comput\n    diy.forEach(k => {\n      obj[k] = comput[k]\n    })\n    return obj\n  }\n  _getData (name, type) {\n    const data = this.options.baseData.call(this, name, type)\n    switch (type) {\n      case 'list':\n        Object.assign(data, this.options.baseListData.call(this, name))\n        break\n      case 'detail':\n        Object.assign(data, this.options.baseDetailData.call(this, name))\n        break\n    }\n    const options = this._getModuleOptions(name, type)\n    return Object.assign(data, options.data.call(this))\n  }\n  _clearStore (name, type) {\n    const data = this._getData(name, type)\n    this._setStore(name, type, data)\n  }\n  _getStore (name, type) {\n    return this.store[name][type]\n  }\n  _setStore (name, type, data) {\n    const store = this.store[name][type]\n    Object.assign(store, data)\n  }\n  _getComputed (name, type) {\n    const store = this.store[name][type]\n    const computed = {}\n    Object.keys(store).forEach(k => {\n      computed[k] = {\n        get () {\n          return store[k]\n        },\n        set (val) {\n          store[k] = val\n        }\n      }\n    })\n    return computed\n  }\n  _setFetchKey (name, type, val) {\n    this._fetchKey[name][type] = String(val)\n  }\n  _getFetchKey (name, type) {\n    return this._fetchKey[name][type]\n  }\n  listStore (name, ...diy) {\n    const self = this\n    const type = 'list'\n    const options = self._getModuleOptions(name, type)\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsList () {\n        const vm = this\n\n        function rsList () {\n          const fetch = self._getModuleOptions(name, type).fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          const fullPath = vm.$route.fullPath\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (fullPath !== vm.$route.fullPath) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, fullPath)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsList.init = function init () {\n          self._clearStore(name, type)\n        }\n\n        rsList.search = function search (...arg) {\n          let query = {}\n          /* eslint-disable no-undef */\n          if (typeof event === 'object' && event === arg[0]) {\n            arg[0] = {}\n          }\n          if (utils.isObject(arg[0])) { // search({})\n            query = arg[0]\n          } else if (typeof arg[0] === 'string') { // search('key', val)\n            query[arg[0]] = arg[1]\n          }\n          query = Object.assign({}, vm.$route.query, { [options.pagekey]: '1' }, vm[options.queryKey], query)\n          vm.$router.push({\n            ...vm.$route,\n            query\n          })\n        }\n        rsList.syncQuery = function syncQuery () {\n          const query = vm[options.queryKey]\n          if (utils.isObject(query)) {\n            Object.keys(query).forEach((k) => {\n              if (Object.prototype.hasOwnProperty.call(vm.$route.query, k)) {\n                query[k] = vm.$route.query[k]\n              }\n            })\n          }\n        }\n        return rsList\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  listMixin (name) {\n    const self = this\n    const type = 'list'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        const toKey = to.fullPath\n        if (!key) {\n          self._setFetchKey(name, type, toKey)\n        } else if (key !== toKey) {\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, toKey)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.listStore(name),\n      created () {\n        this.$rsList.syncQuery()\n        this.$rsList()\n      },\n      watch: {\n        '$route.fullPath' () {\n          this.$rsList.syncQuery()\n          this.$rsList()\n        }\n      }\n    }\n  }\n  detailStore (name, ...diy) {\n    const self = this\n    const type = 'detail'\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsDetail () {\n        const vm = this\n        function rsDetail () {\n          const key = vm.$route.path\n          if (!key) return\n          const fetch = self._getModuleOptions(name, type).fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (key !== vm.$route.path) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, key)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsDetail.init = function init () {\n          self._clearStore(name, type)\n        }\n        return rsDetail\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  detailMixin (name) {\n    const self = this\n    const type = 'detail'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        if (!key) {\n          self._setFetchKey(name, type, to.path)\n        } else if (key && key !== to.path) {\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, to.path)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.detailStore(name),\n      created () {\n        this.$rsDetail()\n      },\n      watch: {\n        '$route.path' () {\n          this.$rsDetail()\n        }\n      }\n    }\n  }\n}\n","import VueRouterStore from './vue-router-store'\nimport install from './install'\n\nVueRouterStore.install = install\n\nexport default VueRouterStore\n"],"names":["_Vue","isDef","v","undefined","install","Vue","installed","defineProperty","prototype","$root","_vrs","store","mixin","$options","vrs","options","opt","res","type","e","Object","assign","utils","obj","toString","call","arr","fn","resolve","reject","btn","back","isFunction","then","catch","msg","Error","process","env","NODE_ENV","console","warn","VueRouterStore","_init","_fetchKey","keys","modules","forEach","name","_getData","$data","defaults","pagekey","queryKey","k","split","replace","toLowerCase","comput","diy","length","data","baseData","baseListData","baseDetailData","_getModuleOptions","_setStore","computed","val","String","self","_getComputed","vm","rsList","fetch","debug","error","fullPath","$route","fetchBefore","next","bind","fetchSuccess","isObject","_setFetchKey","fetchAfter","fetchError","init","_clearStore","search","query","arg","event","$router","push","syncQuery","hasOwnProperty","_returnComput","to","from","key","_getFetchKey","toKey","listStore","$rsList","rsDetail","path","detailStore","$rsDetail"],"mappings":"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"}