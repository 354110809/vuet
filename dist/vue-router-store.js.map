{"version":3,"file":"vue-router-store.js","sources":["../src/install.js","../src/options.js","../src/utils.js","../src/debug.js","../src/vue-router-store.js","../src/index.js"],"sourcesContent":["export let _Vue = null\n\nconst isDef = v => v !== undefined\n\nexport default function install (Vue) {\n  if (install.installed) return\n  install.installed = true\n  _Vue = Vue\n  Object.defineProperty(Vue.prototype, '$vrs', {\n    get () { return this.$root._vrs }\n  })\n  Object.defineProperty(Vue.prototype, '$rs', {\n    get () { return this.$root._vrs.store }\n  })\n  Vue.mixin({\n    beforeCreate () {\n      if (isDef(this.$options.vrs)) {\n        this._vrs = this.$options.vrs\n      }\n    }\n  })\n}\n","export default function options (opt = {}) {\n  const options = {\n    pagekey: 'page', // this.$route.query[pagekey]\n    queryKey: 'query', // this.$data[queryKey]\n    fetchBefore (name, type) {\n      // Callback method before requesting to send\n      // This points to the component instance\n    },\n    fetchAfter (name, type) {\n      // After the request ends, the callback method, regardless of success or failure\n      // This points to the component instance\n    },\n    fetchSuccess (res, name, type) {\n      // Request successful callback\n    },\n    fetchError (e, name, type) {\n      // Request failed callback\n    },\n    baseData (name, type) {\n      // All use\n      return {}\n    },\n    baseListData (name) {\n      // List all use\n      return {}\n    },\n    baseDetailData (name) {\n      // Detail all use\n      return {}\n    },\n    modules: {}\n  }\n  return Object.assign(options, opt)\n}\n","const utils = {\n  isObject (obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isArray (arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]'\n  },\n  isFunction (arr) {\n    return Object.prototype.toString.call(arr) === '[object Function]'\n  },\n  next (fn, resolve, reject = (e) => {}) {\n    let btn = false\n    const back = fn(resolve, reject)\n    if (typeof back === 'object' && utils.isFunction(back.then)) {\n      back\n        .then((res) => {\n          if (btn) return\n          btn = true\n          resolve(res)\n        })\n        .catch(reject)\n    }\n  }\n}\nexport default utils\n","export default {\n  error (msg) {\n    throw new Error(`[vue-router-store] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vue-router-store] ${msg}`)\n    }\n  }\n}\n","import { _Vue } from './install'\nimport options from './options'\nimport utils from './utils'\nimport debug from './debug'\n\nexport default class VueRouterStore {\n  constructor (opt) {\n    this.options = options(opt = opt || {})\n    this._init()\n  }\n  _init () {\n    const store = {}\n    const _fetchKey = {}\n    Object.keys(this.options.modules).forEach(name => {\n      store[name] = {\n        list: this._getData(name, 'list'),\n        detail: this._getData(name, 'detail')\n      }\n      _fetchKey[name] = {\n        list: '',\n        detail: ''\n      }\n    })\n    this.store = new _Vue({\n      data: {\n        store\n      }\n    }).$data.store\n    this._fetchKey = _fetchKey\n  }\n  _getModuleOptions (name, type) {\n    const options = this.options.modules[name]\n    const defaults = {\n      pagekey: this.options.pagekey,\n      queryKey: this.options.queryKey,\n      fetch (next) {\n        return {}\n      },\n      data () {\n        return {}\n      }\n    }\n    Object.keys(options).forEach(k => {\n      let name = (k.split(type)[1] || '')\n      name = name.replace(/^(\\w)/, (v) => v.toLowerCase()) // 首字母大写\n      if (name) {\n        defaults[name] = options[k]\n      } else {\n        defaults[name] = options[k]\n      }\n    })\n    return defaults\n  }\n  _returnComput (comput, diy) {\n    const obj = {}\n    if (!diy.length) return comput\n    diy.forEach(k => {\n      obj[k] = comput[k]\n    })\n    return obj\n  }\n  _getData (name, type) {\n    const data = this.options.baseData.call(this, name, type)\n    switch (type) {\n      case 'list':\n        Object.assign(data, this.options.baseListData.call(this, name))\n        break\n      case 'detail':\n        Object.assign(data, this.options.baseDetailData.call(this, name))\n        break\n    }\n    const options = this._getModuleOptions(name, type)\n    return Object.assign(data, options.data.call(this))\n  }\n  _clearStore (name, type) {\n    const data = this._getData(name, type)\n    this._setStore(name, type, data)\n  }\n  _getStore (name, type) {\n    return this.store[name][type]\n  }\n  _setStore (name, type, data) {\n    const store = this.store[name][type]\n    Object.assign(store, data)\n  }\n  _getComputed (name, type) {\n    const store = this.store[name][type]\n    const computed = {}\n    Object.keys(store).forEach(k => {\n      computed[k] = {\n        get () {\n          return store[k]\n        },\n        set (val) {\n          store[k] = val\n        }\n      }\n    })\n    return computed\n  }\n  _setFetchKey (name, type, val) {\n    this._fetchKey[name][type] = String(val)\n  }\n  _getFetchKey (name, type) {\n    return this._fetchKey[name][type]\n  }\n  listStore (name, ...diy) {\n    const self = this\n    const type = 'list'\n    const options = self._getModuleOptions(name, type)\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsList () {\n        const vm = this\n\n        function rsList () {\n          const fetch = self._getModuleOptions(name, type).fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          const fullPath = vm.$route.fullPath\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (fullPath !== vm.$route.fullPath) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, fullPath)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsList.init = function init () {\n          self._clearStore(name, type)\n        }\n\n        rsList.search = function search (...arg) {\n          let query = {}\n          /* eslint-disable no-undef */\n          if (typeof event === 'object' && event === arg[0]) {\n            arg[0] = {}\n          }\n          if (utils.isObject(arg[0])) { // search({})\n            query = arg[0]\n          } else if (typeof arg[0] === 'string') { // search('key', val)\n            query[arg[0]] = arg[1]\n          }\n          query = Object.assign({}, vm.$route.query, { [options.pagekey]: '1' }, vm[options.queryKey], query)\n          vm.$router.push({\n            ...vm.$route,\n            query\n          })\n        }\n        rsList.syncQuery = function syncQuery () {\n          const query = vm[options.queryKey]\n          if (utils.isObject(query)) {\n            Object.keys(query).forEach((k) => {\n              if (Object.prototype.hasOwnProperty.call(vm.$route.query, k)) {\n                query[k] = vm.$route.query[k]\n              }\n            })\n          }\n        }\n        return rsList\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  listMixin (name) {\n    const self = this\n    const type = 'list'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        const toKey = to.fullPath\n        if (!key) {\n          self._setFetchKey(name, type, toKey)\n        } else if (key !== toKey) {\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, toKey)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.listStore(name),\n      created () {\n        this.$rsList.syncQuery()\n        this.$rsList()\n      },\n      watch: {\n        '$route.fullPath' () {\n          this.$rsList.syncQuery()\n          this.$rsList()\n        }\n      }\n    }\n  }\n  detailStore (name, ...diy) {\n    const self = this\n    const type = 'detail'\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsDetail () {\n        const vm = this\n        function rsDetail () {\n          const key = vm.$route.path\n          if (!key) return\n          const fetch = self._getModuleOptions(name, type).fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (key !== vm.$route.path) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, key)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsDetail.init = function init () {\n          self._clearStore(name, type)\n        }\n        return rsDetail\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  detailMixin (name) {\n    const self = this\n    const type = 'detail'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        if (!key) {\n          self._setFetchKey(name, type, to.path)\n        } else if (key && key !== to.path) {\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, to.path)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.detailStore(name),\n      created () {\n        this.$rsDetail()\n      },\n      watch: {\n        '$route.path' () {\n          this.$rsDetail()\n        }\n      }\n    }\n  }\n}\n","import VueRouterStore from './vue-router-store'\nimport install from './install'\n\nVueRouterStore.install = install\n\nexport default VueRouterStore\n"],"names":["_Vue","isDef","v","undefined","install","Vue","installed","defineProperty","prototype","$root","_vrs","store","mixin","$options","vrs","options","opt","name","type","res","e","Object","assign","utils","obj","toString","call","arr","fn","resolve","reject","btn","back","isFunction","then","catch","msg","Error","process","env","NODE_ENV","console","warn","VueRouterStore","_init","_fetchKey","keys","modules","forEach","_getData","$data","defaults","pagekey","queryKey","next","k","split","replace","toLowerCase","comput","diy","length","data","baseData","baseListData","baseDetailData","_getModuleOptions","_setStore","computed","val","String","self","_getComputed","vm","rsList","fetch","debug","error","fullPath","$route","fetchBefore","bind","fetchSuccess","isObject","_setFetchKey","fetchAfter","fetchError","init","_clearStore","search","query","arg","event","$router","push","syncQuery","hasOwnProperty","_returnComput","to","from","key","_getFetchKey","toKey","listStore","$rsList","rsDetail","path","detailStore","$rsDetail"],"mappings":"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"}