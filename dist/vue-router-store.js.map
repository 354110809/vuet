{"version":3,"file":"vue-router-store.js","sources":["../src/install.js","../src/options.js","../src/utils.js","../src/debug.js","../src/vue-router-store.js","../src/index.js"],"sourcesContent":["export let _Vue = null\n\nconst isDef = v => v !== undefined\n\nexport default function install (Vue) {\n  if (install.installed) return\n  install.installed = true\n  _Vue = Vue\n  Object.defineProperty(Vue.prototype, '$vrs', {\n    get () { return this.$root._vrs }\n  })\n  Object.defineProperty(Vue.prototype, '$rs', {\n    get () { return this.$root._vrs.store }\n  })\n  Vue.mixin({\n    beforeCreate () {\n      if (isDef(this.$options.vrs)) {\n        this._vrs = this.$options.vrs\n      }\n    }\n  })\n}\n","export default function options (opt = {}) {\n  const options = {\n    pagekey: 'page', // this.$route.query[pagekey]\n    queryKey: 'query', // this.$data[queryKey]\n    detailParamsKey: 'id', // this.$route.params[detailParamsKey]\n    fetchBefore (name, type) {\n      // Callback method before requesting to send\n      // This points to the component instance\n    },\n    fetchAfter (name, type) {\n      // After the request ends, the callback method, regardless of success or failure\n      // This points to the component instance\n    },\n    fetchSuccess (res, name, type) {\n      // Request successful callback\n    },\n    fetchError (e, name, type) {\n      // Request failed callback\n    },\n    baseData (name, type) {\n      // All use\n      return {}\n    },\n    baseListData (name) {\n      // List all use\n      return {}\n    },\n    baseDetailData (name) {\n      // Detail all use\n      return {}\n    },\n    modules: {}\n  }\n  return Object.assign(options, opt)\n}\n","const utils = {\n  isObject (obj) {\n    return Object.prototype.toString.call(obj) === '[object Object]'\n  },\n  isArray (arr) {\n    return Object.prototype.toString.call(arr) === '[object Array]'\n  },\n  isFunction (arr) {\n    return Object.prototype.toString.call(arr) === '[object Function]'\n  },\n  next (fn, resolve, reject = (e) => {}) {\n    let btn = false\n    const back = fn(resolve, reject)\n    if (typeof back === 'object' && utils.isFunction(back.then)) {\n      back\n        .then((res) => {\n          if (btn) return\n          btn = true\n          resolve(res)\n        })\n        .catch(reject)\n    }\n  }\n}\nexport default utils\n","export default {\n  error (msg) {\n    throw new Error(`[vue-router-store] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vue-router-store] ${msg}`)\n    }\n  }\n}\n","import { _Vue } from './install'\nimport options from './options'\nimport utils from './utils'\nimport debug from './debug'\n\nexport default class VueRouterStore {\n  constructor (opt) {\n    this.options = options(opt = opt || {})\n    this._init()\n  }\n  _init () {\n    const store = {}\n    const _fetchKey = {}\n    Object.keys(this.options.modules).forEach(name => {\n      store[name] = {\n        list: this._getData(name, 'list'),\n        detail: this._getData(name, 'detail')\n      }\n      _fetchKey[name] = {\n        list: '',\n        detail: ''\n      }\n    })\n    this.store = new _Vue({\n      data: {\n        store\n      }\n    }).$data.store\n    this._fetchKey = _fetchKey\n  }\n  _getModuleOptions (name, type) {\n    const options = this.options.modules[name]\n    const defaults = {\n      pagekey: this.options.pagekey,\n      queryKey: this.options.queryKey,\n      paramsKey: this.options.detailParamsKey,\n      fetch (next) {\n        return {}\n      },\n      data () {\n        return {}\n      }\n    }\n    Object.keys(options).forEach(k => {\n      let name = (k.split(type)[1] || '')\n      name = name.replace(/^(\\w)/, (v) => v.toLowerCase()) // 首字母大写\n      if (name) {\n        defaults[name] = options[k]\n      } else {\n        defaults[name] = options[k]\n      }\n    })\n    return defaults\n  }\n  _returnComput (comput, diy) {\n    const obj = {}\n    if (!diy.length) return comput\n    diy.forEach(k => {\n      obj[k] = comput[k]\n    })\n    return obj\n  }\n  _getData (name, type) {\n    const data = this.options.baseData.call(this, name, type)\n    switch (type) {\n      case 'list':\n        Object.assign(data, this.options.baseListData.call(this, name))\n        break\n      case 'detail':\n        Object.assign(data, this.options.baseDetailData.call(this, name))\n        break\n    }\n    const options = this._getModuleOptions(name, type)\n    return Object.assign(data, options.data.call(this))\n  }\n  _clearStore (name, type) {\n    const data = this._getData(name, type)\n    this._setStore(name, type, data)\n  }\n  _getStore (name, type) {\n    return this.store[name][type]\n  }\n  _setStore (name, type, data) {\n    const store = this.store[name][type]\n    Object.assign(store, data)\n  }\n  _getComputed (name, type) {\n    const store = this.store[name][type]\n    const computed = {}\n    Object.keys(store).forEach(k => {\n      computed[k] = {\n        get () {\n          return store[k]\n        },\n        set (val) {\n          store[k] = val\n        }\n      }\n    })\n    return computed\n  }\n  _setFetchKey (name, type, val) {\n    this._fetchKey[name][type] = String(val)\n  }\n  _getFetchKey (name, type) {\n    return this._fetchKey[name][type]\n  }\n  listStore (name, ...diy) {\n    const self = this\n    const type = 'list'\n    const options = self._getModuleOptions(name, type)\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsList () {\n        const vm = this\n\n        function rsList () {\n          const fetch = self._getModuleOptions(name, type).fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          const fullPath = vm.$route.fullPath\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (fullPath !== vm.$route.fullPath) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, fullPath)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsList.init = function init () {\n          self._clearStore(name, type)\n        }\n\n        rsList.search = function search (...arg) {\n          let query = {}\n          /* eslint-disable no-undef */\n          if (typeof event === 'object' && event === arg[0]) {\n            arg[0] = {}\n          }\n          if (utils.isObject(arg[0])) { // search({})\n            query = arg[0]\n          } else if (typeof arg[0] === 'string') { // search('key', val)\n            query[arg[0]] = arg[1]\n          }\n          let myQuery = {}\n          if (vm.$route[options.pagekey]) {\n            myQuery[options.pagekey] = '1'\n          }\n          query = Object.assign({}, vm.$route.query, myQuery, vm[options.queryKey], query)\n          vm.$router.push({\n            ...vm.$route,\n            query\n          })\n        }\n        rsList.syncQuery = function syncQuery () {\n          const query = vm[options.queryKey]\n          if (utils.isObject(query)) {\n            Object.keys(query).forEach((k) => {\n              if (Object.prototype.hasOwnProperty.call(vm.$route.query, k)) {\n                query[k] = vm.$route.query[k]\n              }\n            })\n          }\n        }\n        return rsList\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  listMixin (name) {\n    const self = this\n    const type = 'list'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        const toKey = to.fullPath\n        if (!key) { // The first visit of the page\n          self._setFetchKey(name, type, toKey)\n        } else if (key !== toKey) {\n          // If the current access page is different from the previously accessed page\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, toKey)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.listStore(name),\n      created () {\n        this.$rsList.syncQuery()\n        this.$rsList()\n      },\n      watch: {\n        '$route.fullPath' () {\n          this.$rsList.syncQuery()\n          this.$rsList()\n        }\n      }\n    }\n  }\n  detailStore (name, ...diy) {\n    const self = this\n    const type = 'detail'\n    const options = self._getModuleOptions(name, type)\n    const computed = {\n      ...self._getComputed(name, type),\n      $rsDetail () {\n        const vm = this\n        function rsDetail () {\n          const key = vm.$route.path\n          if (!vm.$route.params[options.paramsKey]) return\n          const fetch = options.fetch\n          if (!utils.isFunction(fetch)) {\n            return debug.error(`${type} fetch method is undefined`)\n          }\n          self.options.fetchBefore.call(vm, name, type)\n          utils.next(fetch.bind(vm), (res) => {\n            const back = self.options.fetchSuccess.call(vm, res, name, type)\n            if (utils.isObject(back)) {\n              res = back\n            }\n            if (key !== vm.$route.path) return\n            self._setStore(name, type, res)\n            self._setFetchKey(name, type, key)\n            self.options.fetchAfter.call(vm, name, type)\n          }, (e) => {\n            self.options.fetchError.call(vm, e, name, type)\n            self.options.fetchAfter.call(vm, name, type)\n          })\n        }\n        rsDetail.init = function init () {\n          self._clearStore(name, type)\n        }\n        return rsDetail\n      }\n    }\n    return this._returnComput(computed, diy)\n  }\n  detailMixin (name) {\n    const self = this\n    const type = 'detail'\n    return {\n      beforeRouteEnter (to, from, next) {\n        const key = self._getFetchKey(name, type)\n        if (!key) {\n          self._setFetchKey(name, type, to.path)\n        } else if (key && key !== to.path) {\n          self._clearStore(name, type)\n          self._setFetchKey(name, type, to.path)\n        }\n        if (utils.isFunction(next)) {\n          next()\n        }\n      },\n      computed: self.detailStore(name),\n      created () {\n        this.$rsDetail()\n      },\n      watch: {\n        '$route.path' () {\n          this.$rsDetail()\n        }\n      }\n    }\n  }\n}\n","import VueRouterStore from './vue-router-store'\nimport install from './install'\n\nVueRouterStore.install = install\n\nexport default VueRouterStore\n"],"names":["_Vue","isDef","v","undefined","install","Vue","installed","defineProperty","prototype","$root","_vrs","store","mixin","$options","vrs","options","opt","name","type","res","e","Object","assign","utils","obj","toString","call","arr","fn","resolve","reject","btn","back","isFunction","then","catch","msg","Error","process","env","NODE_ENV","console","warn","VueRouterStore","_init","_fetchKey","keys","modules","forEach","_getData","$data","defaults","pagekey","queryKey","detailParamsKey","next","k","split","replace","toLowerCase","comput","diy","length","data","baseData","baseListData","baseDetailData","_getModuleOptions","_setStore","computed","val","String","self","_getComputed","vm","rsList","fetch","debug","error","fullPath","$route","fetchBefore","bind","fetchSuccess","isObject","_setFetchKey","fetchAfter","fetchError","init","_clearStore","search","query","arg","event","myQuery","$router","push","syncQuery","hasOwnProperty","_returnComput","to","from","key","_getFetchKey","toKey","listStore","$rsList","rsDetail","path","params","paramsKey","detailStore","$rsDetail"],"mappings":"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"}