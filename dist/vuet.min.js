!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vuet=t.Vuet||{})}(this,function(t){"use strict";function e(){var t=this;if(this.$vuet){var e=this.$vuet.options.syncQuery,n=void 0===e?"query":e,r=this[n];l.isObject(r)&&Object.keys(r).forEach(function(e){Object.prototype.hasOwnProperty.call(t.$route.query,e)&&(r[e]=t.$route.query[e])})}}function n(t){n.installed||(n.installed=!0,y=t,Object.defineProperty(t.prototype,"$vuet",{get:function(){return this.$root._vuet}}),t.mixin({beforeCreate:function(){b(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.init(this))},destroyed:function(){b(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.destroy(this))}}),Object.keys(p).forEach(function(t){m.use(p[t])}))}function r(){var t={};"string"==typeof arguments[0]?t[arguments[0]]=arguments[1]:l.isObject(arguments[0])&&(t=arguments[0]);var e={};return Object.keys(t).forEach(function(n){var r=t[n];e[n]={get:function(){return this.$vuet.store[r]},set:function(t){this.$vuet.store[r]=t}}}),e}function o(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){var n=e.split("/"),r=f(n,3),o=r[0],i=r[1],u=r[2],s=d[i];t.push(s.mixin(e,o,u))}),t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),s=u.value}catch(t){return void n(t)}if(!u.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},f=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h={name:"route",install:function(t,e){},mixin:function(t,e,n){function r(t,e,n){Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!1})}function o(){var e=t.split("/"),n=f(e,3),r=n[0],o=n[1],i=n[2];return this.$vuet.options.modules[r][o][i]}function i(t,e){"string"==typeof e&&(e=[e]);var n=function(t,e){return e.split(".").forEach(function(e){t=t[e]}),t},r=[];return e.forEach(function(e){var o=n(t,e);isNaN(o)||(o=String(o)),r.push(JSON.stringify(o))}),r}function s(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}return{beforeCreate:function(){var e=this;return u(regeneratorRuntime.mark(function n(){var u,a,c,f;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.$vuet.__route__||r(e.$vuet,"__route__",{}),u=o.call(e),a=u.watch,c=void 0===a?"fullPath":a,f=i(e.$route,c),e.$vuet.__route__[t]||(e.$vuet.__route__[t]=f),s(f,e.$vuet.__route__[t])&&(e.$vuet.reset(t),e.$vuet.__route__[t]=f),n.next=7,e.$vuet.fetch(t,{current:e});case 7:e.$vuet.__route__[t]=f;case 8:case"end":return n.stop()}},n,e)}))()},watch:{$route:{deep:!0,handler:function(e,n){var r=this;return u(regeneratorRuntime.mark(function u(){var a,c,f,h,l;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=o.call(r),c=a.watch,f=void 0===c?"fullPath":c,h=i(e,f),l=i(n,f),s(h,l)){u.next=5;break}return u.abrupt("return",!1);case 5:return u.next=7,r.$vuet.fetch(t,r);case 7:r.$vuet.__route__[t]=h;case 8:case"end":return u.stop()}},u,r)}))()}}}}}},l={isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},forEachObj:function(t,e){l.isObject(t)&&Object.keys(t).forEach(function(n){e(t[n],n)})}},v={name:"syncQuery",install:function(t,n){t.mixin({created:function(){e.call(this)},watch:{$route:function(){e.call(this)}}})}},p={route:h,syncQuery:v},y=null,b=function(t){return void 0!==t},d={},m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,t),this.options=e,this.app=null,this.store={},this.beforeHooks=[],this.afterHooks=[],this.vm=null}return a(t,[{key:"beforeEach",value:function(t){this.beforeHooks.push(t)}},{key:"afterEach",value:function(t){this.afterHooks.push(t)}},{key:"init",value:function(t){var e=this;this.app||(this.app=t,this.vm=new y({data:{store:this.store}}),this._options={data:this.options.data||function(){return{}},modules:{}},l.forEachObj(this.options.modules,function(t,n){l.forEachObj(t,function(t,r){l.forEachObj(t,function(t,o){var i=n+"/"+r+"/"+o;e._options.modules[i]=e.options.modules[n][r][o],e.reset(i)})})}))}},{key:"setStore",value:function(t,e){if(!this.store[t])return y.set(this.store,t,e);Object.assign(this.store[t],e)}},{key:"getStore",value:function(t){return this.store[t]}},{key:"reset",value:function(t){var e=this.options.data(),n=this._options.modules[t];l.isFunction(n.data)&&Object.assign(e,n.data.call(this,t)),this.setStore(t,e)}},{key:"fetch",value:function(t,e){var n=this,r=this._options.modules[t],o={path:t,params:e,store:this.getStore(t)},i=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];for(var i=0;i<n[t].length;i++){var u;if((u=n[t][i]).call.apply(u,[n].concat(r)))return!1}};return!1===i("beforeHooks",o)&&Promise.resolve(o.store),r.fetch.call(this).then(function(e){return!1===i("afterHooks",null,o)?o.store:(n.setStore(t,e),o.store)}).catch(function(t){return!1===i("afterHooks",t,o)?Promise.resolve(o.store):Promise.reject(t)})}},{key:"search",value:function(t,e){var n=this.app.$route,r=n.hash,o=n.query,u=n.params,s=n.name;("object"===("undefined"==typeof event?"undefined":i(event))&&event===t||!l.isObject(t))&&(t={});var a={hash:r,query:c({},o,t),params:c({},u),name:s};e?this.app.$router.replace(a):this.app.$router.push(a)}},{key:"destroy",value:function(){this.vm.$destroy()}}]),t}();m.use=function(t,e){return l.isFunction(t.install)&&t.install(y,m,e),"string"==typeof t.name||t.name?(d[t.name]=t,this):this},m.install=n,t.default=m,t.mapStores=r,t.mapMixins=o,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=vuet.min.js.map
