!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vuet=t.Vuet||{})}(this,function(t){"use strict";function e(t){e.installed||(e.installed=!0,c=t,Object.defineProperty(t.prototype,"$vuet",{get:function(){return this.$root._vuet}}),t.mixin({beforeCreate:function(){f(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.init(this))},destroyed:function(){f(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.destroy(this))}}),Object.keys(a).forEach(function(t){v.use(a[t])}))}function n(){var t=h.getArgMerge.apply(null,arguments),e={};return Object.keys(t).forEach(function(n){var r=t[n];e[n]={get:function(){return this.$vuet.store[r]},set:function(t){this.$vuet.store[r]=t}}}),e}function r(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){var n=e.split("/")[1],r=l[n];t.push(r.mixin(e))}),t}var o=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),s=u.value}catch(t){return void n(t)}if(!u.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}},i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s={name:"route",install:function(t,e){},mixin:function(t){function e(t,e,n){Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!1})}function n(){return this.$vuet._options.modules[t]}function r(t,e){"string"==typeof e&&(e=[e]);var n=function(t,e){return e.split(".").forEach(function(e){t=t[e]}),t},r=[];return e.forEach(function(e){var o=n(t,e);isNaN(o)||(o=String(o)),r.push(JSON.stringify(o))}),r}function i(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}return{beforeCreate:function(){var u=this;return o(regeneratorRuntime.mark(function o(){var s,a,c,f;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return u.$vuet.__route__||e(u.$vuet,"__route__",{}),s=n.call(u),a=s.watch,c=void 0===a?"fullPath":a,f=r(u.$route,c),u.$vuet.__route__[t]||(u.$vuet.__route__[t]=f),i(f,u.$vuet.__route__[t])&&(u.$vuet.reset(t),u.$vuet.__route__[t]=f),o.next=7,u.$vuet.fetch(t,{current:u});case 7:u.$vuet.__route__[t]=f;case 8:case"end":return o.stop()}},o,u)}))()},watch:{$route:{deep:!0,handler:function(e,u){var s=this;return o(regeneratorRuntime.mark(function o(){var a,c,f,h,l;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=n.call(s),c=a.watch,f=void 0===c?"fullPath":c,h=r(e,f),l=r(u,f),i(h,l)){o.next=5;break}return o.abrupt("return",!1);case 5:return o.next=7,s.$vuet.fetch(t,s);case 7:s.$vuet.__route__[t]=h;case 8:case"end":return o.stop()}},o,s)}))()}}}}}},a={route:s},c=null,f=function(t){return void 0!==t},h={isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},forEachObj:function(t,e){h.isObject(t)&&Object.keys(t).forEach(function(n){e(t[n],n)})},getArgMerge:function(){var t={};return"string"==typeof arguments[0]?t[arguments[0]]=arguments[1]:h.isObject(arguments[0])&&(t=arguments[0]),t}},l={},v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),this.options=e,this.app=null,this.store={},this.beforeHooks=[],this.afterHooks=[],this.vm=null}return u(t,[{key:"beforeEach",value:function(t){this.beforeHooks.push(t)}},{key:"afterEach",value:function(t){this.afterHooks.push(t)}},{key:"init",value:function(t){var e=this;this.app||(this.app=t,this.vm=new c({data:{store:this.store}}),this._options={data:this.options.data||function(){return{}},modules:{}},h.forEachObj(this.options.modules,function(t,n){h.forEachObj(t,function(t,r){h.forEachObj(t,function(t,o){var i=n+"/"+r+"/"+o;e._options.modules[i]=e.options.modules[n][r][o],e.reset(i)})})}))}},{key:"setState",value:function(t,e){if(!this.store[t])return c.set(this.store,t,e);Object.assign(this.store[t],e)}},{key:"getState",value:function(t){return this.store[t]}},{key:"reset",value:function(t){var e=this.options.data(),n=this._options.modules[t];h.isFunction(n.data)&&Object.assign(e,n.data.call(this,t)),this.setState(t,e)}},{key:"fetch",value:function(t,e){var n=this,r=this._options.modules[t],o={path:t,params:e,store:this.getState(t)},i=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];for(var i=0;i<n[t].length;i++){var u;if((u=n[t][i]).call.apply(u,[n].concat(r)))return!1}};return!1===i("beforeHooks",o)&&Promise.resolve(o.store),r.fetch.call(this).then(function(e){return!1===i("afterHooks",null,o,e)?o.store:(n.setState(t,e),o.store)}).catch(function(t){return!1===i("afterHooks",t,o)?Promise.resolve(o.store):Promise.reject(t)})}},{key:"destroy",value:function(){this.vm.$destroy()}}]),t}();v.use=function(t,e){return h.isFunction(t.install)&&t.install(c,v,e),"string"==typeof t.name||t.name?(l[t.name]=t,this):this},v.install=e,t.default=v,t.mapState=n,t.mapMixins=r,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=vuet.min.js.map
