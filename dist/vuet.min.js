!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vuet=t.Vuet||{})}(this,function(t){"use strict";function e(){var t=this;if(this.$vuet){var e=this.$vuet.options.syncQuery,n=void 0===e?"query":e,r=this[n];h.isObject(r)&&Object.keys(r).forEach(function(e){Object.prototype.hasOwnProperty.call(t.$route.query,e)&&(r[e]=t.$route.query[e])})}}function n(t){n.installed||(n.installed=!0,v=t,Object.defineProperty(t.prototype,"$vuet",{get:function(){return this.$root._vuet}}),t.mixin({beforeCreate:function(){y(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.init(this))},destroyed:function(){y(this.$options.vuet)&&(this._vuet=this.$options.vuet,this._vuet.destroy(this))}}),Object.keys(p).forEach(function(t){d.use(p[t])}))}function r(){var t=h.getArgMerge.apply(null,arguments),e={};return Object.keys(t).forEach(function(n){var r=t[n];e[n]={get:function(){return this.$vuet.store[r]},set:function(t){this.$vuet.store[r]=t}}}),e}function o(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){var n=e.split("/")[1],r=b[n];t.push(r.mixin(e))}),t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(o,i){try{var u=e[o](i),s=u.value}catch(t){return void n(t)}if(!u.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},f={name:"route",install:function(t,e){},mixin:function(t){function e(t,e,n){Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!1})}function n(){return this.$vuet._options.modules[t]}function r(t,e){"string"==typeof e&&(e=[e]);var n=function(t,e){return e.split(".").forEach(function(e){t=t[e]}),t},r=[];return e.forEach(function(e){var o=n(t,e);isNaN(o)||(o=String(o)),r.push(JSON.stringify(o))}),r}function o(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0;return!1}return{beforeCreate:function(){var i=this;return u(regeneratorRuntime.mark(function u(){var s,a,c,f;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return i.$vuet.__route__||e(i.$vuet,"__route__",{}),s=n.call(i),a=s.watch,c=void 0===a?"fullPath":a,f=r(i.$route,c),i.$vuet.__route__[t]||(i.$vuet.__route__[t]=f),o(f,i.$vuet.__route__[t])&&(i.$vuet.reset(t),i.$vuet.__route__[t]=f),u.next=7,i.$vuet.fetch(t,{current:i});case 7:i.$vuet.__route__[t]=f;case 8:case"end":return u.stop()}},u,i)}))()},watch:{$route:{deep:!0,handler:function(e,i){var s=this;return u(regeneratorRuntime.mark(function u(){var a,c,f,h,l;return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=n.call(s),c=a.watch,f=void 0===c?"fullPath":c,h=r(e,f),l=r(i,f),o(h,l)){u.next=5;break}return u.abrupt("return",!1);case 5:return u.next=7,s.$vuet.fetch(t,s);case 7:s.$vuet.__route__[t]=h;case 8:case"end":return u.stop()}},u,s)}))()}}}}}},h={isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},forEachObj:function(t,e){h.isObject(t)&&Object.keys(t).forEach(function(n){e(t[n],n)})},getArgMerge:function(){var t={};return"string"==typeof arguments[0]?t[arguments[0]]=arguments[1]:h.isObject(arguments[0])&&(t=arguments[0]),t}},l={name:"syncQuery",install:function(t,n){t.mixin({created:function(){e.call(this)},watch:{$route:function(){e.call(this)}}})}},p={route:f,syncQuery:l},v=null,y=function(t){return void 0!==t},b={},d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,t),this.options=e,this.app=null,this.store={},this.beforeHooks=[],this.afterHooks=[],this.vm=null}return a(t,[{key:"beforeEach",value:function(t){this.beforeHooks.push(t)}},{key:"afterEach",value:function(t){this.afterHooks.push(t)}},{key:"init",value:function(t){var e=this;this.app||(this.app=t,this.vm=new v({data:{store:this.store}}),this._options={data:this.options.data||function(){return{}},modules:{}},h.forEachObj(this.options.modules,function(t,n){h.forEachObj(t,function(t,r){h.forEachObj(t,function(t,o){var i=n+"/"+r+"/"+o;e._options.modules[i]=e.options.modules[n][r][o],e.reset(i)})})}))}},{key:"setState",value:function(t,e){if(!this.store[t])return v.set(this.store,t,e);Object.assign(this.store[t],e)}},{key:"getState",value:function(t){return this.store[t]}},{key:"reset",value:function(t){var e=this.options.data(),n=this._options.modules[t];h.isFunction(n.data)&&Object.assign(e,n.data.call(this,t)),this.setState(t,e)}},{key:"fetch",value:function(t,e){var n=this,r=this._options.modules[t],o={path:t,params:e,store:this.getState(t)},i=function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];for(var i=0;i<n[t].length;i++){var u;if((u=n[t][i]).call.apply(u,[n].concat(r)))return!1}};return!1===i("beforeHooks",o)&&Promise.resolve(o.store),r.fetch.call(this).then(function(e){return!1===i("afterHooks",null,o,e)?o.store:(n.setState(t,e),o.store)}).catch(function(t){return!1===i("afterHooks",t,o)?Promise.resolve(o.store):Promise.reject(t)})}},{key:"search",value:function(t,e){var n=this.app.$route,r=n.hash,o=n.query,u=n.params,s=n.name;("object"===("undefined"==typeof event?"undefined":i(event))&&event===t||!h.isObject(t))&&(t={});var a={hash:r,query:c({},o,t),params:c({},u),name:s};e?this.app.$router.replace(a):this.app.$router.push(a)}},{key:"destroy",value:function(){this.vm.$destroy()}}]),t}();d.use=function(t,e){return h.isFunction(t.install)&&t.install(v,d,e),"string"==typeof t.name||t.name?(b[t.name]=t,this):this},d.install=n,t.default=d,t.mapState=r,t.mapMixins=o,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=vuet.min.js.map
